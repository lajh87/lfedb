{
  "hash": "731dbbfd70d1afef334c467459ff6f2f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Using GPT with R\"\nauthor: \"Luke Heley\"\ndate: \"2024-02-20\"\ncategories: [method, llm]\n---\n\n\nThe code chunk below shows how to extract issues from a chunk of text using Chat GPT.\n\n\n\n```{.r .cell-code}\nsection_md <- readLines(\"example.md\") |> paste(collapse = \"\\n\")\n```\n\n```\nWarning in readLines(\"example.md\"): incomplete final line found on 'example.md'\n```\n\n```{.r .cell-code}\nsection_md\n```\n\n[1] \"## 1a. Project description, progress and key future events\\n\\nAn all-weather, 24 hours, general-purpose bombing requirement which offered increased accuracy to reduce collateral damage was identified during the 1991 Gulf War and re-emphasised in subsequent operations. The Precision Guided Bomb (PGB) programme was established to meet this requirement and Raytheon Systems Limited (RSL), who offered the Paveway IV weapon, was selected as the Prime Contractor following international competition. Investment Appraisals Board (IAB) approval was given in June 2003 for the procurement of the Weapon System and integration onto Harrier, Tornado and Typhoon aircraft. Contract let was planned for September 2003 however, Departmental funding constraints delayed contract let and limited it to placement of the main Weapon, support and Harrier GR9 Integration Contracts. These contracts were let in December 2003. A further submission will be made once the way forward for Tornado and Typhoon integration becomes clear.\\n\\nSince contract let it has been decided to enhance further the weapon through the addition of LASER capability. This enhancement is mutually beneficial to RSL and MOD and is being delivered at no extra cost to the MOD. Progress to date is satisfactory and so far all milestones, including the Weapon System Critical Design Review, have been achieved on time or ahead of schedule. Development hardware has been provided and the qualification programme is well underway.\\n\\nThe delay to contract let is reflected in a pro-rata slip to the Main Gate In Service Date estimates although work is ongoing across the stakeholder community to recover this slip. The effect of the recovery work will become evident later in 2006 once the initial results of the qualification phase are known.\"\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(httr)\n\nkey <- Sys.getenv(\"OPENAI_API_KEY\")\n\nbody <- list(model = \"gpt-3.5-turbo\",\n   messages = list(list(\n     role = \"user\",\n     content = glue::glue(\"list the issues identified in the following text: {section_md}\")\n     )),\n     temperature = 0.7) |>\njsonlite::toJSON(auto_unbox = TRUE)\n\nresp <- POST(url = \"https://api.openai.com/v1/chat/completions\",\n     add_headers(`Content-Type` = \"application/json\",\n                   Authorization = glue::glue(\"Bearer {key}\")),\n     body = body)\n\n\n\ncontent(resp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$id\n[1] \"chatcmpl-8vQmLLKyH8Kwd0CI0MI2s7hilY4hb\"\n\n$object\n[1] \"chat.completion\"\n\n$created\n[1] 1708698325\n\n$model\n[1] \"gpt-3.5-turbo-0125\"\n\n$choices\n$choices[[1]]\n$choices[[1]]$index\n[1] 0\n\n$choices[[1]]$message\n$choices[[1]]$message$role\n[1] \"assistant\"\n\n$choices[[1]]$message$content\n[1] \"1. Departmental funding constraints delaying contract let\\n2. Uncertainty surrounding integration onto Tornado and Typhoon aircraft\\n3. Pro-rata slip to the Main Gate In Service Date estimates\\n4. Recovery work needed to address delays\\n5. Potential impact on project timeline and milestones.\"\n\n\n$choices[[1]]$logprobs\nNULL\n\n$choices[[1]]$finish_reason\n[1] \"stop\"\n\n\n\n$usage\n$usage$prompt_tokens\n[1] 360\n\n$usage$completion_tokens\n[1] 58\n\n$usage$total_tokens\n[1] 418\n\n\n$system_fingerprint\n[1] \"fp_86156a94a0\"\n```\n\n\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}