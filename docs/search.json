[
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome to the LFE Database Blog",
    "section": "",
    "text": "Welcome to the LFE database creation blog. This is used to document the development of the LFE database."
  },
  {
    "objectID": "posts/exploratory-data-analysis/eda.html",
    "href": "posts/exploratory-data-analysis/eda.html",
    "title": "Exploratory Data Analysis",
    "section": "",
    "text": "Show the code\nlibrary(ggplot2)\nlibrary(plotly)"
  },
  {
    "objectID": "posts/exploratory-data-analysis/eda.html#number-of-projects-by-year-and-phase",
    "href": "posts/exploratory-data-analysis/eda.html#number-of-projects-by-year-and-phase",
    "title": "Exploratory Data Analysis",
    "section": "Number of Projects by Year and Phase",
    "text": "Number of Projects by Year and Phase\nThe chart below shows the number of projects per year and by phase of project.\n\n\nShow the code\ng &lt;- project_meta |&gt;\n  dplyr::group_by(project_type_label, year) |&gt;\n  dplyr::count()  |&gt;\n  ggplot(aes(year, n)) + \n  geom_bar(aes(fill = project_type_label), stat = \"identity\") \n\nggplotly(g)"
  },
  {
    "objectID": "posts/exploratory-data-analysis/eda.html#project-by-type",
    "href": "posts/exploratory-data-analysis/eda.html#project-by-type",
    "title": "Exploratory Data Analysis",
    "section": "Project by Type",
    "text": "Project by Type\nThe chart below shows the count of project types by project.\n\n\nShow the code\ng &lt;- project_meta  |&gt;\n  dplyr::mutate(\n    project_label = ifelse(\n      test = nchar(project_label)&gt;30, \n      yes = paste0(substr(project_label, 1, 30),\"...\"),\n      no = project_label\n    )\n  ) |&gt;\n  dplyr::group_by(project_label, project_type_label) |&gt;\n  dplyr::count() |&gt;\n  ggplot() + \n  geom_bar(\n    aes(x = factor(project_label,rev(unique(project_label))), \n        y = n, \n        fill = project_type_label), \n    stat = \"identity\") + \n  coord_flip() +\n  labs(x = \"\", y = \"\", fill = \"\")\n\nggplotly(g, height = 1000)"
  },
  {
    "objectID": "posts/exploratory-data-analysis/eda.html#project-by-year-and-type",
    "href": "posts/exploratory-data-analysis/eda.html#project-by-year-and-type",
    "title": "Exploratory Data Analysis",
    "section": "Project by Year and Type",
    "text": "Project by Year and Type\nThe heatmap below shows the project, year and project type.\n\n\nShow the code\ng &lt;- project_meta |&gt;\n  dplyr::mutate(\n    project_label = ifelse(\n      test = nchar(project_label)&gt;30, \n      yes = paste0(substr(project_label, 1, 30),\"...\"),\n      no = project_label\n    )\n  ) |&gt;\n  dplyr::group_by(project_label,project_type_label, year) |&gt;\n  dplyr::count()  |&gt;\n  ggplot() + \n  geom_tile(\n    aes(\n      x = year, \n      y = factor(project_label,rev(unique(project_label))),\n      fill = project_type_label)\n    ) +\n  labs(x = \"\", y = \"\", fill = \"\")\n\nggplotly(g, height = 1000)"
  },
  {
    "objectID": "posts/exploratory-data-analysis/eda.html#project-by-section",
    "href": "posts/exploratory-data-analysis/eda.html#project-by-section",
    "title": "Exploratory Data Analysis",
    "section": "Project by Section",
    "text": "Project by Section\nThe chart below shows a count of level 1 headings by year for D&M phase projects.\nThe data suggests that the report changed format in 2009. It also suggests that there is a need to go back and clean the headings for data from 2009 as there are many level 2 headings mislabelled as level 1 headings.\n\n\nShow the code\nd &lt;- \"../../data-raw/naomprss\"\nf &lt;- list.files(d, pattern = \"md\")\nsections &lt;- purrr::map_df(file.path(d, f), ~{\n  \n  text_in &lt;- readLines(.x) \n  heading_i &lt;- text_in |&gt;\n    stringr::str_detect(\"^#\") |&gt;\n    which()\n  \n  file &lt;- unlist(stringr::str_split(.x, \"/\"))\n  file &lt;- tools::file_path_sans_ext(file[length(file)])\n  \n  file_split &lt;- unlist(stringr::str_split(file, \"_\"))\n  year &lt;- file_split[2]\n  page_from = file_split[3]\n  page_to = file_split[4]\n  \n  df &lt;- dplyr::tibble(\n    heading = text_in[heading_i],\n    from = heading_i\n  ) |&gt;\n    dplyr::mutate(\n      to = dplyr::lead(from)-1\n    ) |&gt;\n    tidyr::replace_na(list(to = length(heading_i))) |&gt;\n    dplyr::mutate(year = as.numeric(year),\n                  page_from = as.numeric(page_from),\n                  page_to = as.numeric(page_to)) \n  \n  chars &lt;- df |&gt; purrr::pmap_dbl(function(from, to, ...){\n    nchar(paste(text_in[from:to], collapse = \"\\n\"))\n  })\n  \n  df$nchar &lt;- chars\n  return(df)\n})\n\nproject_section &lt;- sections |&gt; \n  dplyr::left_join(project_meta,\n    by = c(\"year\", \"page_from\", \"page_to\")\n  )\n\n\ng &lt;- project_section |&gt;\n  dplyr::filter(project_type_label == \"D&M\") |&gt;\n  dplyr::filter(stringr::str_detect(heading, \"^# \")) |&gt;\n  dplyr::mutate(heading = ifelse(\n    test = nchar(heading &gt; 30),\n    yes = paste0(substr(heading, 1, 30), \"...\"),\n    no = heading\n  )) |&gt;\n  dplyr::group_by(year, heading)  |&gt;\n  dplyr::count() |&gt;\n  ggplot() + geom_bar(aes(heading, n), stat = \"identity\") +\n  facet_grid(year ~ ., scales = \"free\", drop = TRUE, space = \"free_y\") + \n  coord_flip()\n\nggplotly(g, height = 2000)\n\n\n\n\n\n\nIn the modelling phase we extract the issues from projects within their D&M phase between 2005 and 2008.\nThe chart below shows the number of headings by year for D&M phase projects.\nThe data are mostly well formed. Some further cleaning to create uniform headers could be carried out.\n\n\nShow the code\ng &lt;- project_section |&gt;\n  dplyr::filter(project_type_label == \"D&M\") |&gt;\n  dplyr::filter(year &lt; 2009) |&gt;\n  group_by(heading, year) |&gt;\n  dplyr::count() |&gt;\n  dplyr::arrange(-n, heading) |&gt;\n  ggplot() + geom_bar(aes(factor(heading, rev(unique(heading))), n, fill = as.factor(year)), stat = \"identity\") +\n  coord_flip() +\n  theme(legend.position = \"bottom\") + \n  labs(x = \"\", y = \"\", fill = \"\")\n\nggplotly(g, height = 1000)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This blog documents the process for extracting unstructured opensource information to a structured database."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Creating LFE Database",
    "section": "",
    "text": "Exploratory Data Analysis\n\n\n\n\n\n\neda\n\n\n\n\n\n\n\n\n\nFeb 20, 2024\n\n\nLuke Heley\n\n\n\n\n\n\n\n\n\n\n\n\nUsing GPT with R\n\n\n\n\n\n\nmethod\n\n\nllm\n\n\n\n\n\n\n\n\n\nFeb 20, 2024\n\n\nLuke Heley\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome to the LFE Database Blog\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\nFeb 20, 2024\n\n\nLuke Heley\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/using-chat-gpt-with-r/using-chat-gpt-with-r.html",
    "href": "posts/using-chat-gpt-with-r/using-chat-gpt-with-r.html",
    "title": "Using GPT with R",
    "section": "",
    "text": "The code chunk below shows how to extract issues from a chunk of text using Chat GPT.\n\nShow the code\nsection_md &lt;- readLines(\"example.md\") |&gt; paste(collapse = \"\\n\")\n\nWarning in readLines(\"example.md\"): incomplete final line found on 'example.md'\n\nShow the code\nsection_md\n\n[1] “## 1a. Project description, progress and key future eventsall-weather, 24 hours, general-purpose bombing requirement which offered increased accuracy to reduce collateral damage was identified during the 1991 Gulf War and re-emphasised in subsequent operations. The Precision Guided Bomb (PGB) programme was established to meet this requirement and Raytheon Systems Limited (RSL), who offered the Paveway IV weapon, was selected as the Prime Contractor following international competition. Investment Appraisals Board (IAB) approval was given in June 2003 for the procurement of the Weapon System and integration onto Harrier, Tornado and Typhoon aircraft. Contract let was planned for September 2003 however, Departmental funding constraints delayed contract let and limited it to placement of the main Weapon, support and Harrier GR9 Integration Contracts. These contracts were let in December 2003. A further submission will be made once the way forward for Tornado and Typhoon integration becomes clear.contract let it has been decided to enhance further the weapon through the addition of LASER capability. This enhancement is mutually beneficial to RSL and MOD and is being delivered at no extra cost to the MOD. Progress to date is satisfactory and so far all milestones, including the Weapon System Critical Design Review, have been achieved on time or ahead of schedule. Development hardware has been provided and the qualification programme is well underway.delay to contract let is reflected in a pro-rata slip to the Main Gate In Service Date estimates although work is ongoing across the stakeholder community to recover this slip. The effect of the recovery work will become evident later in 2006 once the initial results of the qualification phase are known.”\n\n\nShow the code\nlibrary(httr)\n\nkey &lt;- Sys.getenv(\"OPENAI_API_KEY\")\n\nbody &lt;- list(model = \"gpt-3.5-turbo\",\n   messages = list(list(\n     role = \"user\",\n     content = glue::glue(\"list the issues identified in the following text: {section_md}\")\n     )),\n     temperature = 0.7) |&gt;\njsonlite::toJSON(auto_unbox = TRUE)\n\nresp &lt;- POST(url = \"https://api.openai.com/v1/chat/completions\",\n     add_headers(`Content-Type` = \"application/json\",\n                   Authorization = glue::glue(\"Bearer {key}\")),\n     body = body)\n\n\n\ncontent(resp)\n\n\n$id\n[1] \"chatcmpl-8vQmLLKyH8Kwd0CI0MI2s7hilY4hb\"\n\n$object\n[1] \"chat.completion\"\n\n$created\n[1] 1708698325\n\n$model\n[1] \"gpt-3.5-turbo-0125\"\n\n$choices\n$choices[[1]]\n$choices[[1]]$index\n[1] 0\n\n$choices[[1]]$message\n$choices[[1]]$message$role\n[1] \"assistant\"\n\n$choices[[1]]$message$content\n[1] \"1. Departmental funding constraints delaying contract let\\n2. Uncertainty surrounding integration onto Tornado and Typhoon aircraft\\n3. Pro-rata slip to the Main Gate In Service Date estimates\\n4. Recovery work needed to address delays\\n5. Potential impact on project timeline and milestones.\"\n\n\n$choices[[1]]$logprobs\nNULL\n\n$choices[[1]]$finish_reason\n[1] \"stop\"\n\n\n\n$usage\n$usage$prompt_tokens\n[1] 360\n\n$usage$completion_tokens\n[1] 58\n\n$usage$total_tokens\n[1] 418\n\n\n$system_fingerprint\n[1] \"fp_86156a94a0\""
  }
]